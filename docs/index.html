<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPDC: Multi Party Domain Cryptosystem: Multi Party Domain Cryptosystem (MPDC-I)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mpdc_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MPDC: Multi Party Domain Cryptosystem<span id="projectnumber">&#160;1.0.0.0b (A0)</span>
   </div>
   <div id="projectbrief">MPDC Interior protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Multi Party Domain Cryptosystem (MPDC-I) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>MPDC-I (Multi Party Domain Cryptosystem - Interior Protocol) is a multi‐party key exchange and network security system. It distributes the security of a key exchange between a server and a client across multiple devices. This design leverages the contribution of network agents -trusted devices that each inject a portion of pseudo‐random material into the key exchange process, ensuring that no single entity controls the entire shared-secret derivation.</p>
<p>On an interior network, the server and client establish a shared secret with each authenticated agent using an asymmetric key exchange. The resulting shared-secret, retained for the lifetime of the device's certificate, is used to generate a unique key-stream to encrypt small chunks of pseudo‐random data called "key fragments". These fragments are subsequently combined and hashed to derive the primary session keys that secure the encrypted tunnel between the server and client.</p>
<p>This approach means that any attack involving impersonation or man‐in‐the‐middle tactics would have to simultaneously compromise multiple, independently authenticated network devices. Unlike other schemes that rely solely on expensive classical asymmetric cryptography, MPDC-I utilizes a hybrid asymmetric/symmetric post‐quantum secure design. This provides not only robust security but also scalability and computational efficiency, making it suitable for wide-scale adoption.</p>
<h1><a class="anchor" id="arch_sec"></a>
Architecture Overview</h1>
<p>MPDC-I operates with five key device types, each fulfilling a distinct role within the security ecosystem:</p>
<h2><a class="anchor" id="client_sec"></a>
Client</h2>
<p><b>Role:</b> An end-user network device that initiates secure communication with the MPDC-enabled Application Server.</p>
<p><b>Functions:</b></p><ul>
<li>Generates its own certificate and stores the secret signing key.</li>
<li>Has its certificate signed by the RDS (Root Domain Security), either directly or by proxy through the DLA.</li>
<li>Exchanges master fragment keys (mfk) with Agents and MAS servers, which are used to encrypt key fragments.</li>
<li>Combines key fragments received from Agents with the MAS fragment key to derive secure session keys.</li>
<li>Encrypts and decrypts messages using the session keys through a duplexed, encrypted, and authenticated tunnel.</li>
</ul>
<h2><a class="anchor" id="mas_sec"></a>
MAS (MPDC Application Server)</h2>
<p><b>Role:</b> Acts as the central application server managing secure communications with Clients.</p>
<p><b>Functions:</b></p><ul>
<li>Generates its own certificate and stores the secret signing key.</li>
<li>Has its certificate signed by the RDS, directly or via the DLA.</li>
<li>Validates Client certificates against the RDS root certificate.</li>
<li>Communicates with Agents to obtain key fragments.</li>
<li>Derives session keys used to securely interact with Clients.</li>
<li>Encrypts and decrypts messages over a duplexed, secure tunnel.</li>
</ul>
<h2><a class="anchor" id="agent_sec"></a>
Agent</h2>
<p><b>Role:</b> A trusted network device that injects additional entropy into the key exchange process.</p>
<p><b>Functions:</b></p><ul>
<li>Generates its own certificate and stores its secret signing key.</li>
<li>Has its certificate signed by the RDS, either directly or via the DLA.</li>
<li>Generates key fragments (providing pseudo‐random entropy) for session key derivation.</li>
<li>Securely transmits key fragments to both the MAS and Clients.</li>
<li>Enhances the overall security of session keys through independent cryptographic processes.</li>
</ul>
<h2><a class="anchor" id="dla_sec"></a>
DLA (Domain List Agent)</h2>
<p><b>Role:</b> Manages device registration and certificate validation within the network.</p>
<p><b>Functions:</b></p><ul>
<li>Generates its own certificate and stores the secret signing key.</li>
<li>Has its certificate signed by the RDS.</li>
<li>Validates device certificates using the RDS certificate.</li>
<li>Maintains a master list of trusted devices (network topology).</li>
<li>Distributes certificates and topology updates.</li>
<li>Manages certificate revocation and device resignation.</li>
<li>Handles topological queries from network devices.</li>
</ul>
<h2><a class="anchor" id="rds_sec"></a>
RDS (Root Domain Security Server)</h2>
<p><b>Role:</b> Serves as the root certificate authority (trust anchor) for the network.</p>
<p><b>Functions:</b></p><ul>
<li>Generates and manages the root certificate.</li>
<li>Signs device certificates to authenticate identity and trust.</li>
<li>May operate as a certificate signing proxy in conjunction with the DLA.</li>
</ul>
<h1><a class="anchor" id="protocol_sec"></a>
MPDC-I Protocol Overview</h1>
<p>MPDC-I distributes the key exchange security across multiple devices:</p><ul>
<li><b>Key Fragment Exchange:</b> Each Agent on the network, authenticated by the RDS, contributes a unique key fragment. These fragments are generated using computationally inexpensive symmetric cryptography.</li>
<li><b>Session Key Derivation:</b> The MAS and Client combine key fragments from all participating Agents with a MAS-specific fragment key. This combination is hashed to derive the primary session keys used to encrypt the communication tunnel.</li>
<li><b>Security Benefits:</b> An adversary must impersonate multiple devices simultaneously to break the session keys, making man-in-the-middle attacks practically infeasible.</li>
<li><b>Hybrid Cryptography:</b> MPDC-I employs a post-quantum secure hybrid model combining asymmetric and symmetric cryptography, achieving both high security and efficient performance.</li>
</ul>
<h1><a class="anchor" id="config_sec"></a>
MPDC Example Configuration</h1>
<p>The following steps outline a typical configuration and network initialization process:</p>
<ul>
<li><b>RDS Initialization:</b><ul>
<li>Log in to the RDS server and issue the 'enable' command.</li>
<li>Configure your user name, password, device name, IP address, and network name.</li>
<li>Switch to config mode, then certificate mode.</li>
<li>Generate a root certificate with the command:<ul>
<li>'generate(days-valid)' (specify the certificate validity period in days).</li>
</ul>
</li>
</ul>
</li>
<li><b>DLA Initialization:</b><ul>
<li>Log in to the DLA server and issue the 'enable' command.</li>
<li>When prompted, supply the path to the root certificate generated by the RDS.</li>
<li>Switch to certificate mode and generate the DLA certificate.</li>
</ul>
</li>
<li><b>RDS Certificate Signing:</b><ul>
<li>On the RDS, switch to certificate mode and sign the DLA's certificate using:<ul>
<li>'sign(certificate-path)' (where <em>certificate-path</em> is the file path to the DLA certificate).</li>
</ul>
</li>
<li>Transfer the signed certificate back to the DLA either manually (server restart may be required) or using the import command in certificate mode.</li>
</ul>
</li>
<li><b>Device Initialization (Agent, MAS, Client):</b><ul>
<li>For each device (Agent, MAS, and Client), generate a certificate and corresponding key-pair.</li>
<li>Get each certificate signed by the RDS directly or via the DLA.</li>
<li>Register each device with the DLA, which validates the certificate and updates the network topology.</li>
</ul>
</li>
<li><b>MAS and Agent Integration:</b><ul>
<li>On the MAS, join the network by contacting the DLA and obtaining a list of available Agents.</li>
<li>Enable the IP service on the MAS.</li>
<li>On each Agent, enable the IP service and register with the DLA using:<ul>
<li>'register(dla-ip-address)'.</li>
</ul>
</li>
</ul>
</li>
<li><b>Client Integration:</b><ul>
<li>On each Client, enable the IP service and register with the DLA.</li>
<li>Exchange certificates and master fragment keys with Agents and the MAS.</li>
<li>In server mode, use the command 'connect(mas-ip-address)' to establish an encrypted tunnel with a MAS.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="file_sec"></a>
File Description</h1>
<p>The MPDC library is modular and organized as follows:</p>
<ul>
<li><b><a class="el" href="mpdc_8h.html" title="MPDC Common Definitions and Protocol Configuration.">mpdc.h</a>:</b> Contains the primary MPDC library api, including constants, structures, and functions used by all servers and clients.</li>
<li><b><a class="el" href="server_8h.html" title="The common MPDC server functions.">server.h</a>:</b> Contains common server functions for managing configuration, state, certificates, logging, and topology.</li>
<li><b><a class="el" href="network_8h.html" title="The MPDC network functions.">network.h</a>:</b> Provides secure communication protocols, key exchanges, and certificate management routines.</li>
<li><b><a class="el" href="topology_8h.html" title="The MPDC topology functions.">topology.h</a>:</b> Manages the network topology, including node registration, serialization, and updates.</li>
<li><b><a class="el" href="trust_8h.html" title="The MPDC trust functions.">trust.h</a>:</b> Handles trust metrics for network devices including serialization and deserialization of trust structures.</li>
<li><b><a class="el" href="agent_8h.html" title="MPDC Agent Server Interface.">agent.h</a>:</b> Implements the Agent security server functionality.</li>
<li><b><a class="el" href="client_8h.html" title="MPDC Client Functions.">client.h</a>:</b> Implements the MPDC Client functionality.</li>
<li><b><a class="el" href="dla_8h.html" title="MPDC Domain List Agent (DLA) Server.">dla.h</a>:</b> Implements the Domain List Agent server functionality.</li>
<li><b><a class="el" href="mas_8h.html" title="The MPDC Application Server.">mas.h</a>:</b> Implements the MPDC Application Server functionality.</li>
<li><b><a class="el" href="rds_8h.html" title="The MPDC Root Domain Security server.">rds.h</a>:</b> Implements the Root Domain Security server functionality.</li>
</ul>
<h1><a class="anchor" id="usage_sec"></a>
Getting Started</h1>
<p>To use the MPDC library:</p><ul>
<li>Include the necessary header files in your project (e.g., <code><a class="el" href="server_8h.html" title="The common MPDC server functions.">server.h</a></code>, <code><a class="el" href="network_8h.html" title="The MPDC network functions.">network.h</a></code>, <code><a class="el" href="topology_8h.html" title="The MPDC topology functions.">topology.h</a></code>, <code><a class="el" href="trust_8h.html" title="The MPDC trust functions.">trust.h</a></code>, <code><a class="el" href="rds_8h.html" title="The MPDC Root Domain Security server.">rds.h</a></code>).</li>
<li>Initialize the appropriate server type (Client, MAS, Agent, DLA, or RDS) via the provided API functions.</li>
<li>Follow the configuration steps detailed above to properly set up your secure MPDC network.</li>
</ul>
<h2><a class="anchor" id="library_dependencies"></a>
Cryptographic Dependencies</h2>
<p>QSTP uses the QSC cryptographic library: <a href="https://github.com/QRCS-CORP/QSC">The QSC Library</a></p>
<p>QRCS-PL private License. See license file for details. All rights reserved by QRCS Corporation, copyrighted and patents pending.</p>
<dl class="section author"><dt>Author</dt><dd>John G. Underhill </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2025-02-10 </dd></dl>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
