<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Multi Party Domain Cryptosystem: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/MPDC/MPDC/agent.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="mpdc_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Multi Party Domain Cryptosystem<span id="projectnumber">&#160;1.0.0.0b (A0)</span>
   </div>
   <div id="projectbrief">MPDC Interior protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('agent_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">agent.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>MPDC Agent Server Interface.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;common.h&quot;</code><br />
</div>
<p><a href="agent_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad82f66627ce8a433c2302cfcb69f1293" id="r_ad82f66627ce8a433c2302cfcb69f1293"><td class="memItemLeft" align="right" valign="top">MPDC_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad82f66627ce8a433c2302cfcb69f1293">mpdc_agent_pause_server</a> ()</td></tr>
<tr class="memdesc:ad82f66627ce8a433c2302cfcb69f1293"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pause the Agent server.  <br /></td></tr>
<tr class="separator:ad82f66627ce8a433c2302cfcb69f1293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef75ba89032d46998443e81d78a1fc5c" id="r_aef75ba89032d46998443e81d78a1fc5c"><td class="memItemLeft" align="right" valign="top">MPDC_EXPORT_API int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aef75ba89032d46998443e81d78a1fc5c">mpdc_agent_start_server</a> ()</td></tr>
<tr class="memdesc:aef75ba89032d46998443e81d78a1fc5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the Agent server.  <br /></td></tr>
<tr class="separator:aef75ba89032d46998443e81d78a1fc5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23ca3047d7c156fdf6e238a57a178373" id="r_a23ca3047d7c156fdf6e238a57a178373"><td class="memItemLeft" align="right" valign="top">MPDC_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a23ca3047d7c156fdf6e238a57a178373">mpdc_agent_stop_server</a> ()</td></tr>
<tr class="memdesc:a23ca3047d7c156fdf6e238a57a178373"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the Agent server.  <br /></td></tr>
<tr class="separator:a23ca3047d7c156fdf6e238a57a178373"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>MPDC Agent Server Interface. </p>
<p>This header defines the public functions for the MPDC Agent server, a key component of the MPDC network. The Agent server is responsible for managing incoming network connections and processing protocol messages specific to an agent device. Its duties include handling certificate generation and verification, responding to topology convergence requests from the DLA, processing fragment query and master fragment key exchange requests, and managing registration/resign operations.</p>
<p>The Agent server implementation supports a wide range of protocol operations and user commands including:</p>
<ul>
<li><b>Certificate Management:</b> The Agent generates, imports, exports, and validates its own child certificate. It ensures that the certificate is correctly signed by the network's root and conforms to the MPDC certificate structure.</li>
<li><b>Topology and Key Exchange:</b> The server handles convergence responses, fragment query responses, incremental updates, and master fragment key (mfk) exchange responses. These operations guarantee that the agent remains synchronized with the network topology and can securely participate in key exchange operations.</li>
<li><b>Registration and Resignation:</b> The Agent server can register with the DLA (Domain List Agent) to join the MPDC network and send resign requests to remove itself from the network. Upon registration, the agent's certificate is propagated to the topology; on resignation, topology and key collections are reset.</li>
<li><b>Command Loop and User Interaction:</b> A console-based command loop supports operations such as configuration, logging, service control (start/stop/pause/resume), and backup/restore of the agent's state. An idle timeout mechanism automatically logs out inactive sessions.</li>
<li><p class="startli"><b>Network Reception and Error Handling:</b> The Agent's receive loop processes various network packet flags (e.g., converge request, fragment query, mfk request, revocation broadcast) and dispatches them to the appropriate internal functions. Detailed logging and error reporting ensure that issues such as socket failures, authentication errors, and protocol mismatches are detected and handled.</p>
<dl class="test"><dt><b><a class="el" href="test.html#_test000001">Test</a></b></dt><dd>The Agent server implementation has been tested to verify that:</dd></dl>
</li>
<li>The server starts successfully (using both IPv4 and IPv6 configurations) and accepts incoming connections.</li>
<li>Each network packet is correctly deserialized and dispatched based on its protocol flag.</li>
<li>Certificate operations (generation, import, export, and validation) work as expected and adhere to the MPDC certificate format.</li>
<li>Topology convergence, incremental update, and mfk exchange operations perform correctly under simulated network conditions.</li>
<li>The command loop properly interprets and executes user commands and that the idle timeout mechanism logs out inactive sessions.</li>
</ul>
<p>These tests ensure both the correctness of the protocol operations and the robustness of the Agent server under realistic network and user interaction scenarios. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad82f66627ce8a433c2302cfcb69f1293" name="ad82f66627ce8a433c2302cfcb69f1293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad82f66627ce8a433c2302cfcb69f1293">&#9670;&#160;</a></span>mpdc_agent_pause_server()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MPDC_EXPORT_API void mpdc_agent_pause_server </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pause the Agent server. </p>
<p>This function pauses the MPDC Agent server, suspending the processing of network commands and user input. </p>

</div>
</div>
<a id="aef75ba89032d46998443e81d78a1fc5c" name="aef75ba89032d46998443e81d78a1fc5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef75ba89032d46998443e81d78a1fc5c">&#9670;&#160;</a></span>mpdc_agent_start_server()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MPDC_EXPORT_API int32_t mpdc_agent_start_server </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start the Agent server. </p>
<p>This function initializes the MPDC Agent server by setting up the network socket for accepting connections, initializing local state (including certificate and topology information), and starting the main command and receive loops. It also spawns an idle timer thread to monitor user inactivity.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns zero on success; a non-zero value indicates an initialization error. </dd></dl>

</div>
</div>
<a id="a23ca3047d7c156fdf6e238a57a178373" name="a23ca3047d7c156fdf6e238a57a178373"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23ca3047d7c156fdf6e238a57a178373">&#9670;&#160;</a></span>mpdc_agent_stop_server()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MPDC_EXPORT_API void mpdc_agent_stop_server </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the Agent server. </p>
<p>This function stops the MPDC Agent server, terminates the command loop and network receive loop, and cleans up all allocated resources. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_122a33f46074b99ecb54eaab47ea652c.html">MPDC</a></li><li class="navelem"><a class="el" href="agent_8h.html">agent.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
